<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ü¶æ Or√ßameintor | Or√ßamentos Profissionais</title>
  <link rel="icon" type="image/png" href="favicon.png">
  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet" />
  
  <style>
    :root {
      --primaria: #5aa897; --secundaria: #39ffb8; --fundo: #0d1413;
      --fundo-card: #162421; --texto: #d0f0e6; --borda: #2a4741; --perigo: #bc4749;
    }
    body.light { --fundo: #f0f4f3; --fundo-card: #ffffff; --texto: #1b2e2b; --borda: #cbdad7; }

    * { box-sizing: border-box; transition: all 0.3s ease; }
    body { background: var(--fundo); color: var(--texto); font-family: 'Inter', sans-serif; margin: 0; padding: 40px 20px; display: flex; flex-direction: column; align-items: center; }
    .container { width: 100%; max-width: 800px; }

    /* Cabe√ßalho */
    header { text-align: left; margin-bottom: 40px; border-left: 5px solid var(--primaria); padding-left: 20px; }
    h1 { font-family: 'Orbitron', sans-serif; font-weight: 900; font-size: 2.5rem; color: var(--primaria); margin: 0; text-transform: uppercase; letter-spacing: 2px; }
    .subtitle { font-size: 0.9rem; opacity: 0.7; margin-top: 5px; }

    /* Inputs e Cards */
    .card { background: var(--fundo-card); padding: 25px; border-radius: 16px; border: 1px solid var(--borda); box-shadow: 0 10px 30px rgba(0,0,0,0.2); margin-bottom: 20px; }
    label { display: block; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; margin-bottom: 8px; color: var(--primaria); }
    input, textarea { width: 100%; background: rgba(0,0,0,0.2); border: 1px solid var(--borda); border-radius: 8px; padding: 12px; color: var(--texto); font-family: 'Inter', sans-serif; margin-bottom: 20px; }
    input:focus { border-color: var(--secundaria); outline: none; background: rgba(0,0,0,0.3); }

    /* Tabela de Itens Din√¢mica */
    .item-row { display: grid; grid-template-columns: 2fr 1fr 1fr 50px; gap: 15px; align-items: end; margin-bottom: 15px; animation: slideIn 0.3s ease-out; }
    @keyframes slideIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    .btn-del { background: var(--perigo); color: white; border: none; height: 42px; border-radius: 8px; cursor: pointer; font-weight: bold; margin-bottom: 20px; }

    /* Bot√µes Principais */
    .actions-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
    button.main-btn { background: var(--primaria); color: white; border: none; padding: 15px; border-radius: 12px; font-family: 'Orbitron', sans-serif; font-weight: 700; cursor: pointer; box-shadow: 0 4px 15px rgba(90, 168, 151, 0.3); width: 100%; }
    button.main-btn:hover { transform: translateY(-3px); box-shadow: 0 6px 20px rgba(90, 168, 151, 0.5); }

    /* Totalizador */
    .total-container { margin: 40px 0; text-align: right; padding: 20px; background: var(--primaria); color: white; border-radius: 12px; }
    .total-value { font-family: 'Orbitron', sans-serif; font-size: 2.2rem; font-weight: 900; }

    .tema-toggle { position: fixed; top: 20px; right: 20px; padding: 10px; border-radius: 50%; cursor: pointer; background: var(--fundo-card); border: 1px solid var(--borda); z-index: 100; }

    @media (max-width: 600px) { .item-row { grid-template-columns: 1fr; gap: 5px; } .btn-del { width: 100%; margin-bottom: 30px; } }
  </style>
</head>
<body class="dark">

  <div class="tema-toggle" onclick="toggleTema()">üåì</div>

  <div class="container">
    <header>
      <h1>Or√ßameintor</h1>
      <div class="subtitle">O seu trabalho vale muito. Organize e valorize cada detalhe.</div>
    </header>

    <div class="card">
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
        <div><label>Cliente</label><input type="text" id="cliente" placeholder="Para quem √© este projeto?"></div>
        <div><label>Profissional</label><input type="text" id="profissional" placeholder="Seu nome ou empresa"></div>
      </div>
    </div>

    <div class="card">
      <h2 style="font-family: 'Orbitron'; font-size: 1rem; margin: 0 0 20px 0; color: var(--secundaria);">üõ†Ô∏è Materiais e Pe√ßas</h2>
      <div id="listaItens"></div>
      <button class="main-btn" style="background: transparent; border: 1px dashed var(--primaria); color: var(--primaria);" onclick="addItem()">+ Adicionar Item</button>
    </div>

    <div class="card">
      <label>M√£o de Obra e Observa√ß√µes T√©cnicas</label>
      <textarea id="obs" rows="4" placeholder="Descreva aqui o servi√ßo de instala√ß√£o, pintura ou reparo..."></textarea>
    </div>

    <div class="total-container">
      <div style="font-size: 0.8rem; opacity: 0.9;">INVESTIMENTO TOTAL</div>
      <div class="total-value">R$ <span id="valTotal">0,00</span></div>
    </div>

    <div class="actions-grid">
      <button class="main-btn" onclick="gerarPDF()">üßæ Gerar PDF Profissional</button>
      <button class="main-btn" style="background: var(--fundo-card); border: 1px solid var(--primaria); color: var(--primaria);" onclick="exportJSON()">üíæ Salvar Projeto (.json)</button>
    </div>

    <div style="margin-top: 15px;">
      <label for="importJson" style="cursor: pointer; text-align: center; border: 1px solid var(--borda); padding: 10px; border-radius: 8px;">üìÇ Abrir Projeto Salvo</label>
      <input type="file" id="importJson" style="display: none;" accept=".json" onchange="importJSON(event)">
    </div>

    <button onclick="limparTudo()" style="width: 100%; margin-top: 20px; background: transparent; color: var(--perigo); border: none; cursor: pointer; font-size: 0.8rem; opacity: 0.6;">üßπ Limpar todos os campos</button>

    <footer style="margin-top: 80px; text-align: center; font-size: 0.8rem; opacity: 0.7; padding-bottom: 50px;">
      <p>¬© 2026 Or√ßameintor ‚Ä¢ Criado por Gabriel Simeone</p>
      <div style="display: flex; flex-direction: column; align-items: center; gap: 15px; margin-top: 10px;">
        <button onclick="copiarPix()" id="pixBtn" style="background: transparent; border: 1px solid var(--primaria); color: var(--primaria); padding: 8px 20px; border-radius: 30px; cursor: pointer; font-family: 'Orbitron', sans-serif; font-size: 0.7rem;">‚òï APOIE COM UM CAF√âZINHO</button>
        <div style="display: flex; align-items: center; gap: 8px; opacity: 0.5;">
           <img src="favicon.png" alt="Logo" style="width: 18px; filter: grayscale(1);">
              <span>Or√ßameintor v1.8.0</span>
        </div>
      </div>
    </footer>
  </div>

  <script>
    let itens = [];

    function addItem(nome = '', qtd = 0, preco = 0) {
      itens.push({ id: Date.now(), nome, qtd, preco });
      render();
    }

    function updateItem(id, field, value) {
      const item = itens.find(i => i.id === id);
      if (item) {
        item[field] = field === 'nome' ? value : parseFloat(value) || 0;
        calcular();
      }
    }

    function removeItem(id) {
      itens = itens.filter(i => i.id !== id);
      render();
    }

    function calcular() {
      const total = itens.reduce((acc, item) => acc + (item.qtd * item.preco), 0);
      document.getElementById('valTotal').innerText = total.toLocaleString('pt-BR', {minimumFractionDigits: 2});
      salvarLocal();
    }

    function render() {
      const container = document.getElementById('listaItens');
      container.innerHTML = '';
      itens.forEach(item => {
        const row = document.createElement('div');
        row.className = 'item-row';
        row.innerHTML = `
          <div><label>O que ser√° feito?</label><input type="text" value="${item.nome}" placeholder="Ex: C√¢mera, Tinta..." oninput="updateItem(${item.id}, 'nome', this.value)"></div>
          <div><label>Qtd</label><input type="number" value="${item.qtd}" oninput="updateItem(${item.id}, 'qtd', this.value)"></div>
          <div><label>R$ Unit√°rio</label><input type="number" value="${item.preco}" oninput="updateItem(${item.id}, 'preco', this.value)"></div>
          <button class="btn-del" onclick="removeItem(${item.id})">üóëÔ∏è</button>
        `;
        container.appendChild(row);
      });
      calcular();
    }

    function salvarLocal() {
      const dados = {
        cliente: document.getElementById('cliente').value,
        profissional: document.getElementById('profissional').value,
        obs: document.getElementById('obs').value,
        itens
      };
      localStorage.setItem('orcameintor_data', JSON.stringify(dados));
    }

    function carregarLocal() {
      const salvo = localStorage.getItem('orcameintor_data');
      if (salvo) {
        const d = JSON.parse(salvo);
        document.getElementById('cliente').value = d.cliente || '';
        document.getElementById('profissional').value = d.profissional || '';
        document.getElementById('obs').value = d.obs || '';
        itens = d.itens || [];
        render();
      }
    }

    function copiarPix() {
      navigator.clipboard.writeText("biel.simeone@gmail.com");
      const btn = document.getElementById('pixBtn');
      btn.innerText = "‚úÖ CHAVE PIX COPIADA!";
      setTimeout(() => { btn.innerText = "‚òï APOIE COM UM CAF√âZINHO"; }, 3000);
    }

    function gerarPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      const cli = document.getElementById('cliente').value || 'Consumidor';
      const prof = document.getElementById('profissional').value || 'Consultor';
      const total = document.getElementById('valTotal').innerText;

      doc.setFillColor(90, 168, 151); doc.rect(0, 0, 210, 40, 'F');
      doc.setTextColor(255, 255, 255); doc.setFontSize(22); doc.text("OR√áAMENTO PROFISSIONAL", 15, 25);
      
      doc.setTextColor(40, 40, 40); doc.setFontSize(10);
      doc.text(`EMISSOR: ${prof}`, 15, 50);
      doc.text(`CLIENTE: ${cli}`, 15, 55);
      doc.text(`DATA: ${new Date().toLocaleDateString('pt-BR')}`, 155, 50);

      let y = 70;
      doc.setFont("helvetica", "bold");
      doc.text("Descri√ß√£o", 15, y); doc.text("Qtd", 120, y); doc.text("Unit.", 140, y); doc.text("Subtotal", 170, y);
      doc.line(15, y+2, 195, y+2);
      
      y += 10; doc.setFont("helvetica", "normal");
      itens.forEach(i => {
        doc.text(i.nome || 'Item', 15, y);
        doc.text(i.qtd.toString(), 120, y);
        doc.text(i.preco.toFixed(2), 140, y);
        doc.text((i.qtd * i.preco).toLocaleString('pt-BR', {minimumFractionDigits: 2}), 170, y);
        y += 8;
      });

      y += 10; doc.setFont("helvetica", "bold");
      doc.text(`TOTAL: R$ ${total}`, 145, y + 10);

      y += 25; doc.text("M√£o de Obra / Observa√ß√µes:", 15, y);
      doc.setFont("helvetica", "normal");
      const splitObs = doc.splitTextToSize(document.getElementById('obs').value, 180);
      doc.text(splitObs, 15, y + 7);

      doc.save(`orcamento_${cli}.pdf`);
    }

    function exportJSON() {
      const data = localStorage.getItem('orcameintor_data');
      const blob = new Blob([data], {type: 'application/json'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = `projeto.json`;
      a.click();
    }

    function importJSON(e) {
      const reader = new FileReader();
      reader.onload = (event) => {
        const d = JSON.parse(event.target.result);
        document.getElementById('cliente').value = d.cliente;
        document.getElementById('profissional').value = d.profissional;
        document.getElementById('obs').value = d.obs;
        itens = d.itens;
        render();
      };
      reader.readAsText(e.target.files[0]);
    }

    function toggleTema() { document.body.classList.toggle('light'); }
    function limparTudo() { if(confirm("Apagar tudo?")) { localStorage.clear(); location.reload(); } }
    window.onload = carregarLocal;
  </script>
</body>
</html>
